#  
# This file is auto-generated by update.sh  
#  
# @package php/alpine/fpm  
# @author Yannoff <https://github.com/yannoff>  
# @license MIT  
#  
  
FROM php:7.1-fpm-alpine  
  
LABEL author="Yannoff <https://github.com/yannoff>" \  
description="PHP-FPM with basic php extensions and composer" \  
license="MIT"  
# Install basic packages & PHP extensions  
RUN \  
apk add --update postgresql-dev icu-dev curl-dev libxml2-dev bash && \  
docker-php-ext-install pdo pdo_mysql pdo_pgsql intl curl json opcache xml
bcmath; \  
\  
# Install composer  
# - Temporarily install perl-digest-hmac to provide shasum tools  
# - Download composer-setup.php & check for file integrity  
# - Run composer installation script  
# - Cleanup: remove installation script & perl-digest-hmac binaries  
apk add --no-cache --virtual build-deps perl-digest-hmac && \  
curl https://getcomposer.org/installer -o composer-setup.php; \  
ACTUAL_SIG=`shasum -a 384 composer-setup.php | awk '{ printf "%s",$1; }'`; \  
EXPECTED_SIG=`curl -s https://composer.github.io/installer.sig | tr -d "\n"`;
\  
[ "$ACTUAL_SIG" = "$EXPECTED_SIG" ] && \  
php composer-setup.php --filename=composer --install-dir=/usr/bin && \  
rm composer-setup.php && \  
apk del build-deps; \  
\  
# Purge APK cache  
rm -v /var/cache/apk/*  

